# Market API - Market Stall Booking System

à¸£à¸°à¸šà¸šà¸ˆà¸±à¸”à¸à¸²à¸£à¸à¸²à¸£à¸ˆà¸­à¸‡à¸ªà¸–à¸²à¸™à¸—à¸µà¹ˆà¸•à¸±à¹‰à¸‡à¸£à¹‰à¸²à¸™à¸„à¹‰à¸²à¹ƒà¸™à¸•à¸¥à¸²à¸” à¹‚à¸”à¸¢à¹ƒà¸Šà¹‰ Next.js, MongoDB à¹à¸¥à¸° Docker

![Next.js](https://img.shields.io/badge/Next.js-16.1.1-black?logo=next.js)
![Node.js](https://img.shields.io/badge/Node.js-20-green?logo=node.js)
![MongoDB](https://img.shields.io/badge/MongoDB-6.0-green?logo=mongodb)
![Docker](https://img.shields.io/badge/Docker-Latest-blue?logo=docker)

## ğŸ“‹ à¸„à¸³à¸šà¸£à¸£à¸¢à¸²à¸¢

Market API à¹€à¸›à¹‡à¸™à¹€à¸§à¹‡à¸šà¹à¸­à¸›à¸à¸¥à¸´à¹€à¸„à¸Šà¸±à¸™à¸ªà¸³à¸«à¸£à¸±à¸šà¸ˆà¸±à¸”à¸à¸²à¸£à¸à¸²à¸£à¸ˆà¸­à¸‡à¸ªà¸–à¸²à¸™à¸—à¸µà¹ˆà¸•à¸±à¹‰à¸‡à¸£à¹‰à¸²à¸™à¸„à¹‰à¸²à¹ƒà¸™à¸•à¸¥à¸²à¸” à¸›à¸£à¸°à¸à¸­à¸šà¸”à¹‰à¸§à¸¢:
- ğŸ”§ **Backend API** - RESTful API à¸ªà¸³à¸«à¸£à¸±à¸šà¸ˆà¸±à¸”à¸à¸²à¸£à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸à¸²à¸£à¸ˆà¸­à¸‡
- ğŸ’¼ **Admin Dashboard** - à¸«à¸™à¹‰à¸²à¹à¸ªà¸”à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸à¸²à¸£à¸ˆà¸­à¸‡à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸” à¸à¸£à¹‰à¸­à¸¡à¸„à¸¸à¸“à¸ªà¸¡à¸šà¸±à¸•à¸´à¹ƒà¸™à¸à¸²à¸£à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´ à¸›à¸à¸´à¹€à¸ªà¸˜ à¹à¸¥à¸°à¸¥à¸šà¸à¸²à¸£à¸ˆà¸­à¸‡
- ğŸ—„ï¸ **MongoDB Database** - à¸ˆà¸±à¸”à¹€à¸à¹‡à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸à¸²à¸£à¸ˆà¸­à¸‡à¹à¸¥à¸°à¸ªà¸–à¸²à¸™à¸—à¸µà¹ˆà¸•à¹ˆà¸²à¸‡à¹†
- ğŸ³ **Docker Compose** - à¸ªà¸³à¸«à¸£à¸±à¸š containerization à¹à¸¥à¸°à¸à¸²à¸£à¸ˆà¸±à¸”à¸à¸²à¸£ services

## ğŸ› ï¸ à¹€à¸—à¸„à¹‚à¸™à¹‚à¸¥à¸¢à¸µ

| à¹€à¸—à¸„à¹‚à¸™à¹‚à¸¥à¸¢à¸µ | à¹€à¸§à¸­à¸£à¹Œà¸Šà¸±à¸™ | à¸§à¸±à¸•à¸–à¸¸à¸›à¸£à¸°à¸ªà¸‡à¸„à¹Œ |
|----------|---------|-----------|
| Next.js | 16.1.1 | Framework à¸«à¸¥à¸±à¸ |
| React | Latest | UI Components |
| Mongoose | 8.0.0 | ORM à¸ªà¸³à¸«à¸£à¸±à¸š MongoDB |
| Tailwind CSS | Latest | Styling |
| Docker | Latest | Containerization |
| Node.js | 20-alpine | Runtime |

## ğŸ“¦ à¸‚à¹‰à¸­à¸à¸³à¸«à¸™à¸”à¹€à¸šà¸·à¹‰à¸­à¸‡à¸•à¹‰à¸™

- Docker Desktop à¹à¸¥à¸° Docker Compose
- Node.js 20+ (à¸«à¸²à¸à¸£à¸±à¸™ local à¹‚à¸”à¸¢à¹„à¸¡à¹ˆà¹ƒà¸Šà¹‰ Docker)
- npm à¸«à¸£à¸·à¸­ yarn

## ğŸš€ à¸§à¸´à¸˜à¸µà¸à¸²à¸£à¸•à¸´à¸”à¸•à¸±à¹‰à¸‡à¹à¸¥à¸°à¸£à¸±à¸™

### à¸§à¸´à¸˜à¸µ 1: à¹ƒà¸Šà¹‰ Docker Compose (à¹à¸™à¸°à¸™à¸³)

```bash
# Clone repository
git clone https://github.com/suppchai0/market-api.git
cd market-api

# à¸ªà¸£à¹‰à¸²à¸‡à¹à¸¥à¸°à¸£à¸±à¸™ containers
docker-compose up -d

# à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š status
docker-compose ps
```

à¸£à¸°à¸šà¸šà¸ˆà¸°à¸£à¸±à¸™à¹„à¸”à¹‰à¸—à¸µà¹ˆ:
- **Next.js Dashboard**: http://localhost:3000
- **MongoDB**: localhost:27017

### à¸§à¸´à¸˜à¸µ 2: à¸£à¸±à¸™ Local (à¹‚à¸”à¸¢à¹„à¸¡à¹ˆà¹ƒà¸Šà¹‰ Docker)

```bash
# Clone repository
git clone https://github.com/suppchai0/market-api.git
cd market-api

# à¸•à¸´à¸”à¸•à¸±à¹‰à¸‡ dependencies
npm install

# à¸ªà¸£à¹‰à¸²à¸‡ .env.local
echo "MONGODB_URI=mongodb://root:example@localhost:27017/market-api?authSource=admin" > .env.local

# à¸£à¸±à¸™ MongoDB à¸à¹ˆà¸­à¸™ (à¸•à¹‰à¸­à¸‡à¸¡à¸µ MongoDB installed)
mongod

# à¹ƒà¸™à¸­à¸µà¸ terminal à¸£à¸±à¸™ Next.js
npm run dev
```

## ğŸ“Š Project Structure

```
market-api/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ bookings/
â”‚   â”‚       â”œâ”€â”€ route.js           # GET all, POST create
â”‚   â”‚       â””â”€â”€ [id]/
â”‚   â”‚           â””â”€â”€ route.js       # GET single, PUT update, DELETE
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â””â”€â”€ BookingTable.js        # Booking table component
â”‚   â”œâ”€â”€ page.js                    # Admin dashboard
â”‚   â”œâ”€â”€ layout.js                  # Root layout
â”‚   â””â”€â”€ globals.css                # Global styles
â”œâ”€â”€ models/
â”‚   â””â”€â”€ Booking.js                 # Mongoose booking schema
â”œâ”€â”€ lib/
â”‚   â””â”€â”€ mongodb.js                 # MongoDB connection
â”œâ”€â”€ public/                        # Static files
â”œâ”€â”€ docker-compose.yml             # Docker services configuration
â”œâ”€â”€ Dockerfile                     # Next.js container image
â”œâ”€â”€ package.json                   # Dependencies
â”œâ”€â”€ .env.local                     # Environment variables
â””â”€â”€ README.md                      # This file
```

## ğŸ“¡ API Endpoints

### GET - à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸à¸²à¸£à¸ˆà¸­à¸‡à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”

```bash
GET /api/bookings

Response:
{
  "success": true,
  "data": [
    {
      "_id": "...",
      "storeName": "à¸£à¹‰à¸²à¸™à¸‚à¸™à¸¡",
      "ownerName": "à¸™à¸²à¸¢à¸ªà¸¡à¸Šà¸²à¸¢",
      "phone": "0812345678",
      "email": "somchai@example.com",
      "shopType": "food",
      "stallNumber": "A01",
      "bookingDate": "2025-01-10",
      "status": "pending",
      "createdAt": "2025-01-09T...",
      "updatedAt": "2025-01-09T..."
    }
  ]
}
```

### POST - à¸ªà¸£à¹‰à¸²à¸‡à¸à¸²à¸£à¸ˆà¸­à¸‡à¹ƒà¸«à¸¡à¹ˆ

```bash
POST /api/bookings

Body:
{
  "storeName": "à¸£à¹‰à¸²à¸™à¸‚à¸™à¸¡",
  "ownerName": "à¸™à¸²à¸¢à¸ªà¸¡à¸Šà¸²à¸¢",
  "phone": "0812345678",
  "email": "somchai@example.com",
  "shopType": "food",
  "stallNumber": "A01",
  "bookingDate": "2025-01-10"
}

Response:
{
  "success": true,
  "data": { ... }
  "status": 201
}
```

### GET - à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸à¸²à¸£à¸ˆà¸­à¸‡à¹€à¸”à¸µà¸¢à¸§

```bash
GET /api/bookings/:id

Response:
{
  "success": true,
  "data": { ... }
}
```

### PUT - à¸­à¸±à¸à¹€à¸”à¸—à¸ªà¸–à¸²à¸™à¸°à¸à¸²à¸£à¸ˆà¸­à¸‡

```bash
PUT /api/bookings/:id

Body:
{
  "status": "approved"  // or "rejected" or "pending"
}

Response:
{
  "success": true,
  "data": { ... }
}
```

### DELETE - à¸¥à¸šà¸à¸²à¸£à¸ˆà¸­à¸‡

```bash
DELETE /api/bookings/:id

Response:
{
  "success": true,
  "data": { deletedCount: 1 }
}
```

## ğŸ”‘ Environment Variables

à¸ªà¸£à¹‰à¸²à¸‡à¹„à¸Ÿà¸¥à¹Œ `.env.local` à¹ƒà¸™à¹‚à¸Ÿà¸¥à¹€à¸”à¸­à¸£à¹Œ root:

```env
MONGODB_URI=mongodb://root:example@localhost:27017/market-api?authSource=admin
```

**à¸ªà¸³à¸«à¸£à¸±à¸š Docker Compose**: à¸„à¹ˆà¸²à¸•à¸±à¸§à¹à¸›à¸£à¸–à¸¹à¸à¸à¸³à¸«à¸™à¸”à¸­à¸¢à¸¹à¹ˆà¹à¸¥à¹‰à¸§à¹ƒà¸™ `docker-compose.yml`

## ğŸ“ Booking Schema

```javascript
{
  _id: ObjectId,              // Auto-generated
  storeName: String,          // à¸Šà¸·à¹ˆà¸­à¸£à¹‰à¸²à¸™ (à¸šà¸±à¸‡à¸„à¸±à¸š)
  ownerName: String,          // à¸Šà¸·à¹ˆà¸­à¹€à¸ˆà¹‰à¸²à¸‚à¸­à¸‡ (à¸šà¸±à¸‡à¸„à¸±à¸š)
  phone: String,              // à¹€à¸šà¸­à¸£à¹Œà¹‚à¸—à¸£ 10 à¸«à¸¥à¸±à¸ (à¸šà¸±à¸‡à¸„à¸±à¸š)
  email: String,              // à¸­à¸µà¹€à¸¡à¸¥ (à¸šà¸±à¸‡à¸„à¸±à¸š, à¸¡à¸µ validation)
  shopType: String,           // à¸›à¸£à¸°à¹€à¸ à¸—: food, clothing, goods, other (à¸šà¸±à¸‡à¸„à¸±à¸š)
  stallNumber: String,        // à¸«à¸¡à¸²à¸¢à¹€à¸¥à¸‚à¸ªà¸–à¸²à¸™ (à¸šà¸±à¸‡à¸„à¸±à¸š)
  bookingDate: Date,          // à¸§à¸±à¸™à¸—à¸µà¹ˆà¸ˆà¸­à¸‡ (à¸šà¸±à¸‡à¸„à¸±à¸š)
  status: String,             // pending, approved, rejected (default: pending)
  createdAt: Date,            // Auto-generated
  updatedAt: Date             // Auto-generated
}
```

## ğŸ’» Admin Dashboard Features

- âœ… à¸”à¸¹à¸ªà¸–à¸´à¸•à¸´à¸à¸²à¸£à¸ˆà¸­à¸‡ (Total, Pending, Approved, Rejected)
- âœ… à¸•à¸²à¸£à¸²à¸‡à¹à¸ªà¸”à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸à¸²à¸£à¸ˆà¸­à¸‡à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”
- âœ… à¸›à¸¸à¹ˆà¸¡ Approve - à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´à¸à¸²à¸£à¸ˆà¸­à¸‡
- âœ… à¸›à¸¸à¹ˆà¸¡ Reject - à¸›à¸à¸´à¹€à¸ªà¸˜à¸à¸²à¸£à¸ˆà¸­à¸‡
- âœ… à¸›à¸¸à¹ˆà¸¡ Delete - à¸¥à¸šà¸à¸²à¸£à¸ˆà¸­à¸‡
- âœ… Auto-refresh à¸«à¸¥à¸±à¸‡à¸ˆà¸²à¸à¹à¸à¹‰à¹„à¸‚à¸‚à¹‰à¸­à¸¡à¸¹à¸¥
- âœ… Error handling à¹à¸¥à¸° loading states

## ğŸ§ª à¸à¸²à¸£à¸—à¸”à¸ªà¸­à¸š API

### à¹ƒà¸Šà¹‰ curl:

```bash
# à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”
curl http://localhost:3000/api/bookings

# à¸ªà¸£à¹‰à¸²à¸‡à¸à¸²à¸£à¸ˆà¸­à¸‡à¹ƒà¸«à¸¡à¹ˆ
curl -X POST http://localhost:3000/api/bookings \
  -H "Content-Type: application/json" \
  -d '{
    "storeName": "à¸£à¹‰à¸²à¸™à¸à¸²à¹à¸Ÿ",
    "ownerName": "à¸™à¸²à¸¢à¸à¸³à¸˜à¸£",
    "phone": "0898765432",
    "email": "komtorn@example.com",
    "shopType": "food",
    "stallNumber": "B02",
    "bookingDate": "2025-01-15"
  }'

# à¸­à¸±à¸à¹€à¸”à¸—à¸ªà¸–à¸²à¸™à¸°
curl -X PUT http://localhost:3000/api/bookings/:id \
  -H "Content-Type: application/json" \
  -d '{"status": "approved"}'

# à¸¥à¸šà¸à¸²à¸£à¸ˆà¸­à¸‡
curl -X DELETE http://localhost:3000/api/bookings/:id
```

### à¹ƒà¸Šà¹‰ Postman:
1. Import endpoints à¸ˆà¸²à¸ API_GUIDE.md
2. Set Authorization à¸–à¹‰à¸²à¸ˆà¸³à¹€à¸›à¹‡à¸™
3. Test à¹à¸•à¹ˆà¸¥à¸° endpoint

## ğŸ› Troubleshooting

### MongoDB connection error
```bash
# à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸§à¹ˆà¸² container à¸£à¸±à¸™à¸­à¸¢à¸¹à¹ˆ
docker-compose ps

# à¸”à¸¹à¸¥à¸­à¸ MongoDB
docker-compose logs market-mongo

# Restart containers
docker-compose restart
```

### Next.js not starting
```bash
# à¸”à¸¹à¸¥à¸­à¸ Next.js
docker-compose logs market-nextjs

# à¸¥à¸š .next folder à¹à¸¥à¸° restart
docker-compose down
docker-compose up -d --build
```

### Port already in use
```bash
# à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™ port à¹ƒà¸™ docker-compose.yml
# à¸«à¸£à¸·à¸­ kill process à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰ port
lsof -i :3000
kill -9 <PID>
```

## ğŸ“š à¹„à¸Ÿà¸¥à¹Œà¹€à¸à¸´à¹ˆà¸¡à¹€à¸•à¸´à¸¡

- [API_GUIDE.md](API_GUIDE.md) - à¹€à¸­à¸à¸ªà¸²à¸£ API à¹‚à¸”à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”

## ğŸ¤ Contributing

à¸–à¹‰à¸²à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸¡à¸µà¸ªà¹ˆà¸§à¸™à¸£à¹ˆà¸§à¸¡:
1. Fork repository à¸™à¸µà¹‰
2. à¸ªà¸£à¹‰à¸²à¸‡ branch à¸ªà¸³à¸«à¸£à¸±à¸š feature à¹ƒà¸«à¸¡à¹ˆ
3. Commit changes
4. Push à¸‚à¸¶à¹‰à¸™ GitHub
5. à¸ªà¸£à¹‰à¸²à¸‡ Pull Request

## ğŸ“„ License

MIT License

## ğŸ‘¨â€ğŸ’» Author

- GitHub: [@suppchai0](https://github.com/suppchai0)

---

**à¸•à¸´à¸”à¸•à¹ˆà¸­à¸ªà¸³à¸«à¸£à¸±à¸šà¸„à¸³à¸–à¸²à¸¡**: à¸ªà¸²à¸¡à¸²à¸£à¸–à¸ªà¸£à¹‰à¸²à¸‡ Issue à¹ƒà¸™ GitHub repository à¸™à¸µà¹‰à¹„à¸”à¹‰
